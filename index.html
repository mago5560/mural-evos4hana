<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>A-Frame + Div Info</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <style>
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        overflow: hidden;
      }

      /* El div pequeño */
      #miniCard {
        position: absolute;
        top: 20px;
        left: 20px;
        padding: 10px 20px;
        background: #3498db;
        color: white;
        cursor: pointer;
        border-radius: 8px;
        box-shadow: 0px 4px 6px rgba(0,0,0,0.3);
        transition: transform 0.2s;
      }
      #miniCard:hover {
        transform: scale(1.05);
      }

      /* El div grande oculto */
      #infoCard {
        display: none;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 400px;
        background: white;
        color: black;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0px 8px 12px rgba(0,0,0,0.4);
      }

      #closeBtn {
        display: block;
        margin-top: 20px;
        padding: 8px 16px;
        background: #e74c3c;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
      }
      #closeBtn:hover {
        background: #c0392b;
      }
    </style>
  </head>
  <body>
    <!-- Escena A-Frame -->
    <a-scene>

         <!-- Cámara con cursor para poder detectar clics  wasd-controls   movement-controls -->
      <!--
         <a-entity id="rig" movement-controls position="0 1.6 1">
            <a-entity camera look-controls position="0 0 0"></a-entity>
            <a-entity cursor="fuse: true; fuseTimeout: 500"
                     position="0 0 -1"
                     geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                     material="color: black; shader: flat">
            </a-entity>
            <a-cursor></a-cursor>
        </a-entity>
      -->

        <a-entity id="rig" position="0 1.6 0">
                <a-entity camera look-controls="pointerLockEnabled: true" position="0 0 0" wasd-controls="acceleration:50"></a-entity>
                <a-entity cursor="fuse: true; fuseTimeout: 500"
                         position="0 0 -1"
                         geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                         material="color: #7BC8A4; shader: flat">
                </a-entity>
                   
            </a-entity>
      
         <!--
      <a-entity camera 
      look-controls   
 wasd-controls  
   movement-controls="
    controls: gamepad, hand;
    fly: true;
    speed: 0.8"
      position="0 1.6 1">
        <a-cursor></a-cursor>
      </a-entity>   
      -->
      

        <!-- Esfera central de referencia --><!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AR.js Octágonos Interactivos</title>
  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <!-- AR.js para A-Frame -->
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
    .hint { position: fixed; left: 0; right: 0; bottom: 0; padding: 10px 12px; font-family: system-ui, sans-serif; background: rgba(0,0,0,.55); color: #fff; text-align: center; z-index: 10; }
  </style>
</head>
<body>
  <div class="hint">Apunta al marcador <b>Hiro</b>. Toca un octágono para centrarlo y agrandarlo.</div>

  <a-scene
    vr-mode-ui="enabled: false"
    renderer="antialias: true; colorManagement: true"
    embedded
    arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
  >
    <!-- Luz suave para resaltar los bordes -->
    <a-entity light="type: ambient; intensity: 0.8"></a-entity>
    <a-entity light="type: directional; intensity: 0.6" position="1 1 0"></a-entity>

    <!-- Marcador Hiro clásico -->
    <a-marker preset="hiro" id="marker">
      <!-- Contenedor de todos los octágonos -->
      <a-entity id="octagon-group" position="0 0 0"></a-entity>
    </a-marker>

    <!-- Cámara y cursor basado en el puntero (soporta toque/pulsación) -->
    <a-entity camera look-controls>
      <a-cursor rayOrigin="mouse"></a-cursor>
    </a-entity>
  </a-scene>

  <script>
    // Utilidad: crear un "octágono" como cilindro de 8 lados, muy delgado
    function createOctagon(id, position, color, scale = {x:1, y:1, z:1}) {
      const e = document.createElement('a-entity');
      e.setAttribute('id', id);
      e.classList.add('octagon');
      e.setAttribute('geometry', {
        primitive: 'cylinder',
        radius: 0.28,
        height: 0.04,
        segmentsRadial: 8
      });
      e.setAttribute('material', { color, metalness: 0.2, roughness: 0.5 });
      e.setAttribute('position', position);
      e.setAttribute('rotation', '0 0 0');
      e.setAttribute('scale', `${scale.x} ${scale.y} ${scale.z}`);
      // Pequeña sombra de borde
      e.setAttribute('shadow', 'cast: true; receive: true');
      return e;
    }

    const group = document.getElementById('octagon-group');

    // Colores agradables (10 + 1 central)
    const palette = [
      '#FF6B6B', '#FFD93D', '#6BCB77', '#4D96FF', '#B28DFF',
      '#FF8FAB', '#F6BD60', '#84DCC6', '#95A6FF', '#F7A072', '#7AD9F5'
    ];

    // Octágono central inicial
    const centerId = 'octagon-center';
    const center = createOctagon(centerId, '0 0.1 0', palette[10], {x:1.7, y:1.7, z:1.7});
    center.dataset.isCenter = 'true';
    group.appendChild(center);

    // Crear 10 octágonos alrededor en círculo
    const R = 1.35; // radio del anillo
    const Y = 0.1;  // altura
    const count = 10;

    for (let i = 0; i < count; i++) {
      const theta = (i / count) * Math.PI * 2;
      const x = R * Math.cos(theta);
      const z = R * Math.sin(theta);
      const id = `octagon-${i+1}`;
      const oct = createOctagon(id, `${x.toFixed(3)} ${Y} ${z.toFixed(3)}`, palette[i], {x:1, y:1, z:1});
      // Guardar su posición original para intercambios futuros
      oct.dataset.originalPosition = `${x} ${Y} ${z}`;
      group.appendChild(oct);
    }

    // Animar transición suave
    function animateTo(entity, toPos, toScale, dur = 350) {
      entity.setAttribute('animation__pos', {
        property: 'position', to: toPos, dur, easing: 'easeInOutQuad'
      });
      entity.setAttribute('animation__scale', {
        property: 'scale', to: toScale, dur, easing: 'easeInOutQuad'
      });
    }

    function swapToCenter(target) {
      const currentCenter = group.querySelector('[data-is-center="true"]');
      if (!currentCenter || target === currentCenter) return;

      // Posiciones/escala
      const targetOriginalPos = target.getAttribute('position');
      const centerOriginalPos = currentCenter.getAttribute('position');

      const targetOriginalSlot = target.dataset.originalPosition || `${targetOriginalPos.x} ${targetOriginalPos.y} ${targetOriginalPos.z}`;
      const centerScaleSmall = '1 1 1';
      const bigScale = '1.7 1.7 1.7';

      // 1) Mover el target al centro y agrandarlo
      animateTo(target, '0 0.1 0', bigScale);
      target.dataset.isCenter = 'true';

      // 2) Mover el que estaba al centro hacia el lugar original del target y hacerlo pequeño
      animateTo(currentCenter, targetOriginalSlot, centerScaleSmall);
      delete currentCenter.dataset.isCenter;

      // 3) Actualizar data-originalPosition: el que sale al anillo hereda el slot del target
      currentCenter.dataset.originalPosition = targetOriginalSlot;
    }

    // Interacción: tocar/click sobre cualquier octágono del anillo
    group.addEventListener('click', (ev) => {
      const t = ev.target;
      if (!t.classList || !t.classList.contains('octagon')) return;
      if (t.dataset.isCenter === 'true') return;
      swapToCenter(t);
    });

    // Evitar que el tap arrastre la escena en móviles
    document.body.addEventListener('touchmove', (e) => { e.preventDefault(); }, { passive: false });
  </script>
</body>
</html>

  <a-sphere
    position="0 2.5 -5"
    radius="0.3"
    color="#FFFFFF"
    opacity="0.5"
    transparent="true">
  </a-sphere>

  <!-- Octágonos alrededor de la esfera -->
  <a-entity id="octagonos-container">
    <!-- Los 10 octágonos se generarán con JavaScript -->
  </a-entity>


       <!-- Objeto clickeable -->
      <a-box id="miniCardV2" position="0 1.5 -3" rotation="0 45 0" color="#4CC3D9"></a-box>
      <a-plane position="0 0 -4" rotation="-90 0 0" width="10" height="10" color="#7BC8A4"></a-plane>
       
    </a-scene>

    <!-- Div pequeño -->
    <div id="miniCard">Haz clic aquí</div>

    <!-- Div grande oculto -->
    <div id="infoCard">
      <h2>Información Detallada</h2>
      <p>
        Este es un cuadro de información que aparece cuando das clic en el
        botón pequeño. Aquí puedes colocar cualquier texto, imágenes o incluso
        enlaces.
      </p>
      <button id="closeBtn">Cerrar</button>
    </div>

    <script>
      const miniCardV2 = document.getElementById("miniCardV2");
      const miniCard = document.getElementById("miniCard");
      const infoCard = document.getElementById("infoCard");
      const closeBtn = document.getElementById("closeBtn");

      // Evento click de A-Frame
      miniCardV2.addEventListener("click", () => {
        infoCard.style.display = "block";
      });

      miniCard.addEventListener("click", () => {
        infoCard.style.display = "block";
      });

      closeBtn.addEventListener("click", () => {
        infoCard.style.display = "none";
      });

         // Esperar a que la escena cargue
  document.querySelector('a-scene').addEventListener('loaded', function() {
    const container = document.querySelector('#octagonos-container');
    const radio = 2.0;
    const centro = { x: 0, y: 2.5, z: -5 };
    const numOctagonos = 10;
    
    // Array para almacenar los octágonos
    const octagonos = [];
    
    // Crear 10 octágonos distribuidos uniformemente
    for (let i = 0; i < numOctagonos; i++) {
      const angulo = (i / numOctagonos) * Math.PI * 2;
      
      const x = centro.x;
      const y = centro.y + Math.cos(angulo) * radio;
      const z = centro.z + Math.sin(angulo) * radio;
      
      const octagono = document.createElement('a-entity');
      octagono.setAttribute('geometry', {
        primitive: 'cylinder',
        radius: 0.3,
        height: 0.05,
        segmentsRadial: 8,
        openEnded: true
      });
      
      octagono.setAttribute('material', {
        color: `hsl(${(i / numOctagonos) * 360}, 70%, 60%)`,
        metalness: 0.3,
        roughness: 0.4
      });
      
      octagono.setAttribute('position', `${x} ${y} ${z}`);
      
      const anguloRotacion = (angulo * 180 / Math.PI) + 90;
      octagono.setAttribute('rotation', `0 0 ${anguloRotacion}`);
      
      // Añadir clase y ID para identificación
      octagono.setAttribute('class', 'octagono-clickeable');
      octagono.setAttribute('id', `octagono-${i}`);
      
      // Hacerlo interactivo (necesario para eventos click)
      octagono.setAttribute('cursor-listener', '');
      
      // Animación inicial
      octagono.setAttribute('animation', {
        property: 'rotation',
        to: `0 0 ${anguloRotacion + 360}`,
        dur: 15000 + (i * 1000),
        loop: true,
        easing: 'linear'
      });
      
      container.appendChild(octagono);
      octagonos.push(octagono);
    }
    
    // Añadir componente para eventos de cursor
    AFRAME.registerComponent('cursor-listener', {
      init: function () {
        const el = this.el;
        let colorOriginal = el.getAttribute('material').color;
        
        // Evento cuando el cursor entra
        el.addEventListener('mouseenter', function () {
          el.setAttribute('material', 'color', '#FFFFFF');
          el.setAttribute('scale', '1.2 1.2 1.2');
        });
        
        // Evento cuando el cursor sale
        el.addEventListener('mouseleave', function () {
          el.setAttribute('material', 'color', colorOriginal);
          el.setAttribute('scale', '1 1 1');
        });
        
        // Evento CLICK (mousedown para VR)
        el.addEventListener('mousedown', function (evt) {
          console.log('Octágono clickeado:', el.id);
          
          // Efecto visual al hacer click
          el.setAttribute('material', 'color', '#00FF00');
          el.setAttribute('scale', '0.8 0.8 0.8');
          
          // Animación de rebote
          el.setAttribute('animation__click', {
            property: 'scale',
            to: '1.1 1.1 1.1',
            dur: 300,
            easing: 'easeOutElastic',
            startEvents: 'mousedown'
          });
          
          // Restaurar después de un tiempo
          setTimeout(() => {
            el.setAttribute('material', 'color', colorOriginal);
            el.setAttribute('scale', '1 1 1');
          }, 500);
          
          // Aquí puedes agregar tu lógica personalizada
          alert(`¡Octágono ${el.id} clickeado!`);
          
          // Ejemplo: mover este octágono al frente
          const nuevaPosicion = {
            x: 0,
            y: 2.5,
            z: -3
          };
          
          el.setAttribute('animation__move', {
            property: 'position',
            to: `${nuevaPosicion.x} ${nuevaPosicion.y} ${nuevaPosicion.z}`,
            dur: 1000,
            easing: 'easeOutQuad'
          });
        });
      }
    });
  });
    </script>

     <script>
        // Detectar tipo de dispositivo
        const deviceTypeElement = document.getElementById('device-type');
        const gyroStatusElement = document.getElementById('gyro-status');
        
        if (/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)) {
            deviceTypeElement.innerHTML = '<span class="highlight">Dispositivo Móvil</span> detectado';
        } else {
            deviceTypeElement.innerHTML = '<span class="highlight">Ordenador</span> detectado';
        }
        
        // Comprobar disponibilidad del giroscopio
        if (window.DeviceOrientationEvent) {
            window.addEventListener('deviceorientation', function() {
                gyroStatusElement.innerHTML = '<span class="highlight">Giroscopio activo</span> - Mueve el dispositivo';
            });
        } else {
            gyroStatusElement.innerHTML = 'Giroscopio <span class="highlight">no disponible</span> - Usa el ratón';
        }
        
        // Ajustar la sensibilidad de los controles según el dispositivo
        document.querySelector('a-scene').addEventListener('loaded', function() {
            const lookControls = document.querySelector('[look-controls]').components['look-controls'];
            
            if (/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)) {
                // Sensibilidad para móviles
                lookControls.touchSensitivity = 1.5;
            } else {
                // Sensibilidad para ordenadores
                lookControls.pointerSensitivity = 0.8;
            }
        });
    </script>

  </body>
</html>
